<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>আরব জাতিগোষ্ঠী পরিচিতি</title>

<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:'Noto Sans Bengali',sans-serif;
  background:#f8fafc;
  overflow:hidden;
  color:#1e293b;
}
header{
  position:absolute;top:0;left:0;right:0;
  background:#ffffffee;
  border-bottom:1px solid #e5e7eb;
  padding:12px 24px;
  z-index:10;
}
header h1{margin:0;font-size:20px}
header p{margin:2px 0 0;font-size:12px;color:#64748b}

#container{
  position:absolute;
  inset:0;
  cursor:grab;
}
#container.dragging{cursor:grabbing}

#canvas{
  position:absolute;
  transform-origin:0 0;
}

svg{
  position:absolute;
  left:0;top:0;
  overflow:visible;
}

.node{
  position:absolute;
  width:150px;
  height:65px;
  padding:6px;
  border-radius:8px;
  border:2px solid;
  text-align:center;
  font-size:13px;
  font-weight:600;
  cursor:pointer;
  transition:.25s;
  box-shadow:0 2px 6px rgba(0,0,0,.15);
}
.node:hover{
  transform:scale(1.12);
  z-index:50;
  background:#f59e0b!important;
  border-color:#f59e0b!important;
  color:#fff!important;
}

.node.prophet{
  box-shadow:0 0 20px rgba(16,185,129,.7);
}

#drawer{
  position:absolute;
  top:0;right:0;bottom:0;
  width:360px;
  background:white;
  border-left:1px solid #e5e7eb;
  box-shadow:-8px 0 24px rgba(0,0,0,.2);
  display:none;
  flex-direction:column;
  z-index:20;
}
#drawer header{
  background:#047857;
  color:white;
}
#drawer .content{
  padding:16px;
  overflow:auto;
}
.badge{
  display:inline-block;
  background:#f1f5f9;
  border:1px solid #e2e8f0;
  border-radius:999px;
  padding:4px 10px;
  font-size:12px;
  margin:4px;
}
</style>
</head>

<body>

<header>
  <h1>আরব জাতিগোষ্ঠী পরিচিতি</h1>
  <p>PDF সোর্স ভিত্তিক বংশলতিকা</p>
</header>

<div id="container">
  <div id="canvas"></div>
</div>

<div id="drawer">
  <header style="padding:12px">
    <button onclick="drawer.style.display='none'" style="float:right;background:none;border:none;color:white;font-size:18px">✕</button>
    <h3 id="dTitle"></h3>
  </header>
  <div class="content">
    <p id="dInfo"></p>
    <div id="dChildren"></div>
  </div>
</div>

<script>
/* ================= DATA ================= */
const rawData = {
  name:"আরব জাতিগোষ্ঠী",
  type:"root",
  children:[
    {name:"আরবে বায়িদাহ",type:"bayidah"},
    {name:"আরবে আরিবা",type:"ariba"},
    {
      name:"আরবে মুস্তারিবা",
      type:"mustariba",
      children:[
        {
          name:"ইব্রাহিম (আ.)",
          type:"prophet",
          children:[
            {name:"ইসমাঈল (আ.)",type:"prophet",
              children:[
                {name:"আদনান",type:"mustariba",
                  children:[
                    {name:"মুহাম্মাদ ﷺ",type:"prophet"}
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
};

/* ================= CONSTANTS ================= */
const NODE_W=150,NODE_H=65,V_GAP=100,H_GAP=40;

/* ================= LAYOUT ================= */
function layout(node,depth=0){
  node.children=node.children||[];
  const kids=node.children.map(c=>layout(c,depth+1));
  let totalW=NODE_W;
  if(kids.length){
    totalW=kids.reduce((a,c)=>a+c.totalW+H_GAP,0)-H_GAP;
  }
  return {...node,depth,totalW,children:kids};
}
function position(node,x){
  let cx=x;
  node.children.forEach(c=>{
    position(c,cx);
    cx+=c.totalW+H_GAP;
  });
  node.x=x+node.totalW/2-NODE_W/2;
  node.y=node.depth*(NODE_H+V_GAP);
}
const tree=layout(rawData);
position(tree,0);

/* ================= FLATTEN ================= */
const nodes=[],edges=[];
(function walk(n){
  nodes.push(n);
  n.children.forEach(c=>{
    edges.push({a:n,b:c});
    walk(c);
  });
})(tree);

/* ================= BOUNDS ================= */
const minX=Math.min(...nodes.map(n=>n.x))-200;
const minY=Math.min(...nodes.map(n=>n.y))-200;
const maxX=Math.max(...nodes.map(n=>n.x+NODE_W))+200;
const maxY=Math.max(...nodes.map(n=>n.y+NODE_H))+200;

const canvas=document.getElementById("canvas");
canvas.style.width=(maxX-minX)+"px";
canvas.style.height=(maxY-minY)+"px";

/* ================= SVG ================= */
const svg=document.createElementNS("http://www.w3.org/2000/svg","svg");
svg.setAttribute("width",maxX-minX);
svg.setAttribute("height",maxY-minY);
canvas.appendChild(svg);

/* ================= EDGES ================= */
edges.forEach(e=>{
  const p=document.createElementNS(svg.namespaceURI,"path");
  const x1=e.a.x-minX+NODE_W/2,y1=e.a.y-minY+NODE_H;
  const x2=e.b.x-minX+NODE_W/2,y2=e.b.y-minY;
  p.setAttribute("d",`M${x1},${y1} C${x1},${y1+60} ${x2},${y2-60} ${x2},${y2}`);
  p.setAttribute("stroke","#94a3b8");
  p.setAttribute("fill","none");
  p.setAttribute("stroke-width","2");
  svg.appendChild(p);
});

/* ================= NODES ================= */
nodes.forEach(n=>{
  const d=document.createElement("div");
  d.className="node";
  if(n.type==="prophet")d.classList.add("prophet");
  d.style.left=(n.x-minX)+"px";
  d.style.top=(n.y-minY)+"px";
  d.style.background=color(n.type);
  d.style.borderColor=color(n.type);
  d.textContent=n.name;
  d.onclick=e=>{
    e.stopPropagation();
    drawer.style.display="flex";
    dTitle.textContent=n.name;
    dInfo.textContent=n.details?.info||"এই নোডের জন্য অতিরিক্ত তথ্য নেই।";
    dChildren.innerHTML="";
    n.children.forEach(c=>{
      const b=document.createElement("span");
      b.className="badge";
      b.textContent=c.name;
      dChildren.appendChild(b);
    });
  };
  canvas.appendChild(d);
});

/* ================= PAN / ZOOM ================= */
let scale=.6,ox=200,oy=120,drag=false,sx,sy;
function update(){canvas.style.transform=`translate(${ox}px,${oy}px) scale(${scale})`}
update();

container.onmousedown=e=>{drag=true;container.classList.add("dragging");sx=e.clientX-ox;sy=e.clientY-oy};
container.onmousemove=e=>{if(drag){ox=e.clientX-sx;oy=e.clientY-sy;update()}};
container.onmouseup=()=>{drag=false;container.classList.remove("dragging")};
container.onmouseleave=()=>drag=false;
container.onwheel=e=>{e.preventDefault();scale=Math.max(.05,Math.min(3,scale-e.deltaY*0.001));update()};

/* ================= COLOR ================= */
function color(t){
  return {
    root:"#064E3B",
    bayidah:"#9333EA",
    ariba:"#407cde",
    mustariba:"#EA580C",
    prophet:"#047857"
  }[t]||"#64748b";
}
</script>
</body>
</html>
